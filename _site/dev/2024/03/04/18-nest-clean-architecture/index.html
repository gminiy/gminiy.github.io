<!DOCTYPE html>
<html lang="en">
<script src="/assets/lib/jquery-1.12.0.min.js"></script>
<script src="/assets/lib/jquery.magnific-popup.min.js"></script>
<script src="/assets/js/index.js"></script>
<!--
 __  __                __                                     __
/\ \/\ \              /\ \             __                    /\ \
\ \ \_\ \   __  __    \_\ \      __   /\_\      __       ___ \ \ \/'\
 \ \  _  \ /\ \/\ \   /'_` \   /'__`\ \/\ \   /'__`\    /'___\\ \ , <
  \ \ \ \ \\ \ \_\ \ /\ \L\ \ /\  __/  \ \ \ /\ \L\.\_ /\ \__/ \ \ \\`\
   \ \_\ \_\\/`____ \\ \___,_\\ \____\ _\ \ \\ \__/.\_\\ \____\ \ \_\ \_\
    \/_/\/_/ `/___/> \\/__,_ / \/____//\ \_\ \\/__/\/_/ \/____/  \/_/\/_/
                /\___/                \ \____/
                \/__/                  \/___/

Powered by Hydejack v6.4.0 (https://qwtel.com/hydejack/)
-->









<head>
  <script data-ad-client="ca-pub-6794902480931711" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><!-- 구글 애드센스.. -->
  <meta name="naver-site-verification" content="5ed99748eeae22ae60b755d080de65ec0e50cc40" />
  <!-- =============== -->
<!-- META            -->
<!-- =============== -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="format-detection" content="telephone=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta property="og:title" content="[NestJs] 클린 아키텍처">
<meta property="og:type" content="article">




  <meta property="og:image" content="http://localhost:4000/assets/img/logo.png">


<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="360" />



  <title>[NestJs] 클린 아키텍처 &middot; Gmin.Y Blog</title>



<meta name="description" content="
  1. 클린 아키텍처
  2. SOLID 객체 지향 설계 원칙
  3. 유저 서비스에 클린 아키텍처 적용하기
    
      3.1 도메인 레이어
      3.2 어플리케이션 레이어
      3.3 인터페이스 레이어
      3.4 인프라 레이어
      3.5 이메일 모듈
    
  


">
<meta property="og:description" content="
  1. 클린 아키텍처
  2. SOLID 객체 지향 설계 원칙
  3. 유저 서비스에 클린 아키텍처 적용하기
    
      3.1 도메인 레이어
      3.2 어플리케이션 레이어
      3.3 인터페이스 레이어
      3.4 인프라 레이어
      3.5 이메일 모듈
    
  


">



<!-- tipuesearch -->
<link rel="stylesheet" href="/assets/tipuesearch/css/tipuesearch.css">


<!-- =============== -->
<!-- LINKS           -->
<!-- =============== -->
<link rel="canonical" href="http://localhost:4000/dev/2024/03/04/18-nest-clean-architecture/">
<meta property="og:url" content="http://localhost:4000/dev/2024/03/04/18-nest-clean-architecture/">
<meta name="google-site-verification" content="g4I-a_du23AFdfLFV2vuKYLo_phz8igXQAF3pHc57wA" />

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-N0KPWLFWQ2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-N0KPWLFWQ2');
</script>

<link rel="alternate" type="application/atom+xml" title="Gmin.Y Blog Feed" href="http://localhost:4000/feed.xml">


  <link rel="prev" href="http://localhost:4000/dev/2024/03/03/17-nest-cqrs/">



  <link rel="next" href="http://localhost:4000/dev/2024/03/20/19-typescript-item3/">


<link rel="apple-touch-icon" href="http://localhost:4000/apple-touch-icon.png">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?">
<!-- Place favicon.ico in the root directory -->

<!-- =============== -->
<!-- SCRIPTS         -->
<!-- =============== -->

<script>
  !function(n,e){function t(n,e){n.onload=function(){this.onerror=this.onload=null,e(null,n)},n.onerror=function(){this.onerror=this.onload=null,e(new Error("Failed to load "+this.src),n)}}function o(n,e){n.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,e(null,n))}}n._loaded=!1,n.loadJSDeferred=function(a,d){function r(){n._loaded=!0;var r=e.createElement("script");r.src=a,d&&(("onload"in r?t:o)(r,d),r.onload||t(r,d));var l=e.getElementsByTagName("script")[0];l.parentNode.insertBefore(r,l)}n._loaded?r():n.addEventListener?n.addEventListener("load",r,!1):n.attachEvent?n.attachEvent("onload",r):n.onload=r}}(window,document);

  !function(e){"use strict";var n=function(n,t,o){function i(e){if(a.body)return e();setTimeout(function(){i(e)})}function r(){l.addEventListener&&l.removeEventListener("load",r),l.media=o||"all"}var d,a=e.document,l=a.createElement("link");if(t)d=t;else{var f=(a.body||a.getElementsByTagName("head")[0]).childNodes;d=f[f.length-1]}var s=a.styleSheets;l.rel="stylesheet",l.href=n,l.media="only x",i(function(){d.parentNode.insertBefore(l,t?d:d.nextSibling)});var u=function(e){for(var n=l.href,t=s.length;t--;)if(s[t].href===n)return e();setTimeout(function(){u(e)})};return l.addEventListener&&l.addEventListener("load",r),l.onloadcssdefined=u,u(r),l};"undefined"!=typeof exports?exports.loadCSS=n:e.loadCSS=n}("undefined"!=typeof global?global:this);

  !function(t){if(t.loadCSS){var e=loadCSS.relpreload={};if(e.support=function(){try{return t.document.createElement("link").relList.supports("preload")}catch(t){return!1}},e.poly=function(){for(var e=t.document.getElementsByTagName("link"),r=0;r<e.length;r++){var n=e[r];"preload"===n.rel&&"style"===n.getAttribute("as")&&(t.loadCSS(n.href,n,n.getAttribute("media")),n.rel=null)}},!e.support()){e.poly();var r=t.setInterval(e.poly,300);t.addEventListener&&t.addEventListener("load",function(){e.poly(),t.clearInterval(r)}),t.attachEvent&&t.attachEvent("onload",function(){t.clearInterval(r)})}}}(this);

  window.disablePushState = false;
  window.disableDrawer = false;
</script>

<!--[if lt IE 9]>
<script src="https://unpkg.com/html5shiv/dist/html5shiv.min.js"></script>
<![endif]-->

<!-- =============== -->
<!-- STYLES          -->
<!-- =============== -->
<style>
  
  @import url(https://fonts.googleapis.com/earlyaccess/nanumgothic.css);article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}*{box-sizing:border-box}html,body{margin:0;padding:0}html{font-size:16px;line-height:1.75}body{color:#333;background-color:#fff;overflow-y:scroll}a{text-decoration:none}.lead{margin-left:-1rem;margin-right:-1rem}img,.img{display:block;max-width:100%;margin-bottom:1rem;border:none}img.lead,.img.lead{max-width:calc(100% + 2rem);width:calc(100% + 2rem)}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6,.heading{font-weight:bold;text-rendering:optimizeLegibility}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6{margin:1.6rem 0 1rem;line-height:1.6}h1,.h1{font-size:2rem;line-height:1.25}h2,.h2{font-size:1.5rem}h3,.h3{font-size:1.17em}p{margin-top:0;margin-bottom:1rem}p.lead{font-size:1.25rem;font-weight:300;padding:0 1rem}ul,ol,dl{margin-top:0;margin-bottom:1rem}ul,ol{padding-left:1.25rem}hr{position:relative;margin:2rem 0 3rem 0;border:0;border-top:1px solid #eee}.hr{padding-bottom:.5rem;border-bottom:1px solid #eee;margin-bottom:1.5rem}h4,h5,h6,.h4,.h5,.h6{margin-bottom:0.5rem;font-size:1rem}table{margin-bottom:1rem;width:100%;width:calc(100% + 2rem);margin-left:-1rem;border:1px solid #e5e5e5;border-collapse:collapse;border-spacing:0}td,th{padding:.25rem .5rem;border:1px solid #e5e5e5}td:first-child,th:first-child{padding-left:1rem}td:last-child,th:last-child{padding-right:1rem}thead+tbody,tbody+tbody,tfoot{border-top:3px double #e5e5e5}tbody tr:nth-child(odd) td,tbody tr:nth-child(odd) th{background-color:#f9f9f9}footer{margin-bottom:2rem}.page,.post{margin-bottom:3em}.page li+li,.post li+li{margin-top:.25rem}.page>header,.post>header{margin-bottom:2rem}.page-title,.post-title{margin-top:0}.post-date{display:block;margin-top:-0.5rem;margin-bottom:1rem;color:#9a9a9a}.related-posts{padding-left:0;list-style:none}.related-posts>li,.related-posts>li+li{margin-top:1rem}.related-posts>li>small,.related-posts>li+li>small{font-size:75%;color:#9a9a9a}.message{margin-bottom:1rem;padding:1rem;color:#787878;background-color:#f9f9f9;margin-left:-1rem;margin-right:-1rem}body,main{position:relative;overflow-x:hidden}@media screen{body::before{content:'';background:#e5e5e5;position:absolute;left:0;top:0;bottom:0}}@media screen and (min-width: 40em){html{font-size:17px}}@media screen and (min-width: 54em){html{font-size:16px}}@media screen and (min-width: 88em){html{font-size:15px}}@media screen and (min-width: 125em){html{font-size:18px}}.sr-only{display:none}.clearfix,.sidebar-social::after,.clearafter::after{content:"";display:table;clear:both}a,.a{position:relative;padding-bottom:.15rem;border-style:hidden}.img{overflow:hidden;background-color:#f9f9f9}.img>img{margin:0;width:100%;height:100%}.sixteen-nine{position:relative}.sixteen-nine::before{display:block;content:"";width:100%;padding-top:56.25%}.sixteen-nine>*{position:absolute;top:0;left:0;right:0;bottom:0}h1+hr,h2+hr,h3+hr,h4+hr,h5+hr,h6+hr{margin-top:0}.fade-in{animation-duration:500ms;animation-name:fade-in;animation-fill-mode:forwards}@keyframes fade-in{from{transform:translateY(-2rem);opacity:0}50%{transform:translateY(-2rem);opacity:0}to{transform:translateY(0);opacity:1}}.mb6{margin-bottom:10rem}.sidebar{color:rgba(255,255,255,0.75);text-align:left}.sidebar::before{content:"";position:absolute;z-index:2;top:0;left:0;bottom:0;right:0;background:linear-gradient(to bottom, rgba(32,32,32,0) 0%, rgba(32,32,32,0.5) 100%)}.sidebar a{color:#fff;border-bottom-color:rgba(255,255,255,0.2);text-shadow:2px 2px 4px rgba(0,0,0,0.5)}.right-side{width:100%;margin-left:auto;margin-right:auto}.right-side .ad-first{text-align:center}@media screen{.right-side{max-width:38rem;min-height:100vh}.right-side .ad-second{display:none}}@media screen and (min-width: 54em){.right-side{margin-left:20rem;margin-right:1rem;padding:4rem 1rem 12rem}.right-side .ad-second{text-align:center;display:block}}@media screen and (min-width: 72em){.right-side{margin-left:22rem;max-width:42rem}}@media screen and (min-width: 88em){.right-side{width:162px;margin-left:0rem;margin-right:0rem;padding:0rem;margin-top:10rem;display:block;float:left}}@media screen and (min-width: 96em){.right-side{width:300px;margin-right:0rem}}#_yDrawer{position:relative}@media screen{#_yDrawer{min-height:640px;min-height:100vh}}@media screen and (min-width: 54em){#_yDrawer{width:18rem;margin-left:0}}.sidebar-bg{position:absolute;height:100%;overflow:hidden;top:0;right:0;bottom:0;left:0;background:#202020 center / cover}.sidebar-box{display:flex;justify-content:center}.sidebar-sticky{position:relative;z-index:3}@media screen{.sidebar-sticky{-ms-overflow-style:none;overflow:-moz-scrollbars-none;height:100%;overflow:auto;position:absolute;padding:3rem 0rem;right:2.5rem;left:2.5rem}}.sidebar-sticky::-webkit-scrollbar{display:none}.sidebar-about>h1{color:#fff;font-size:2rem}.sidebar-nav>ul{list-style:none;padding-left:0;margin-bottom:0.5rem}a.sidebar-nav-item{width:100%;font-weight:normal;display:block;line-height:1.75;padding:0.25rem 0;border-bottom:1px solid rgba(255,255,255,0.2)}a.sidebar-nav-subitem{font-weight:normal;display:block;line-height:1.75;padding:0.25rem 0;border-bottom:1px solid rgba(255,255,255,0.2)}@media screen{.y-drawer-scrim{z-index:2}.y-drawer-content{width:18rem;left:-18rem;z-index:3}}.sidebar-social{margin-bottom:.5rem}.sidebar-social>ul{list-style:none;padding-left:0;margin:0 -.25rem}.sidebar-social>ul>li{float:left}.sidebar-social>ul>li>a{display:inline-block;text-align:center;font-size:1.6rem;line-height:3rem;width:3.1249rem;height:4rem;padding:.5rem 0}.sidebar-social>ul li+li{margin-top:0}.fixed-top{position:fixed;top:0;left:0;width:100%;z-index:1}.navbar>.content{padding-top:0;padding-bottom:0;min-height:0;height:0}.menu{display:inline-block;padding:1.75rem 1.5rem;border-bottom:none;margin-left:-1.5rem;color:#9a9a9a !important}.menu::after{content:"\2630"}@media screen and (min-width: 54em){.menu{padding:1.25rem 1.5rem;position:absolute;left:-9999px}.menu:focus{position:static}}.animation-main{pointer-events:none}.loading{display:none}@media print{.menu{display:none}}.animation-main{opacity:0;will-change:opacity}.loading{position:absolute;top:0;right:0;padding:5.25rem 4.5rem;transform-origin:top right;transform:scale(0.33)}.content{position:relative;margin-left:auto;margin-right:auto;padding:5rem 1rem 12rem}@media screen{.content{min-height:100vh}}@media screen and (min-width: 54em){.content{padding:4rem 1rem 12rem;margin-left:19rem;margin-right:3rem}}@media screen and (min-width: 72em){.content{max-width:42rem;margin-left:21rem}}@media screen and (min-width: 88em){.content{float:left;width:100%;margin-left:22rem;margin-right:5rem}}@media screen and (min-width: 96em){.content{max-width:60rem}}@media screen and (min-width: 102em){.content{margin-left:25rem;margin-right:8rem}}.me{width:6.5rem;height:6.5rem;align-self:center;margin-right:20px;border-radius:100%;position:relative}@media screen and (min-width: 40em){.me{width:7rem;height:7rem}}@media screen and (min-width: 54em){.me{width:6.5rem;height:6.5rem}}@media screen and (min-width: 72em){.me{width:7rem;height:7rem}}main>footer{width:100%;position:absolute;bottom:0;left:0;right:0;padding:0 1rem;color:#9a9a9a;font-size:smaller;text-align:center}main>footer>p{margin-bottom:0}html{font-family:'Nanum Gothic', 'sans-serif'}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6,.heading{font-family:'Nanum Gothic', 'sans-serif'}

</style>
<!--[if gt IE 8]>-->
<style>
  
  @import url(https://fonts.googleapis.com/earlyaccess/nanumgothic.css);article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}*{box-sizing:border-box}html,body{margin:0;padding:0}html{font-size:16px;line-height:1.75}body{color:#333;background-color:#fff;overflow-y:scroll}a{text-decoration:none}.lead{margin-left:-1rem;margin-right:-1rem}img,.img{display:block;max-width:100%;margin-bottom:1rem;border:none}img.lead,.img.lead{max-width:calc(100% + 2rem);width:calc(100% + 2rem)}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6,.heading{font-weight:bold;text-rendering:optimizeLegibility}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6{margin:1.6rem 0 1rem;line-height:1.6}h1,.h1{font-size:2rem;line-height:1.25}h2,.h2{font-size:1.5rem}h3,.h3{font-size:1.17em}p{margin-top:0;margin-bottom:1rem}p.lead{font-size:1.25rem;font-weight:300;padding:0 1rem}ul,ol,dl{margin-top:0;margin-bottom:1rem}ul,ol{padding-left:1.25rem}hr{position:relative;margin:2rem 0 3rem 0;border:0;border-top:1px solid #eee}.hr{padding-bottom:.5rem;border-bottom:1px solid #eee;margin-bottom:1.5rem}h4,h5,h6,.h4,.h5,.h6{margin-bottom:0.5rem;font-size:1rem}table{margin-bottom:1rem;width:100%;width:calc(100% + 2rem);margin-left:-1rem;border:1px solid #e5e5e5;border-collapse:collapse;border-spacing:0}td,th{padding:.25rem .5rem;border:1px solid #e5e5e5}td:first-child,th:first-child{padding-left:1rem}td:last-child,th:last-child{padding-right:1rem}thead+tbody,tbody+tbody,tfoot{border-top:3px double #e5e5e5}tbody tr:nth-child(odd) td,tbody tr:nth-child(odd) th{background-color:#f9f9f9}footer{margin-bottom:2rem}.page,.post{margin-bottom:3em}.page li+li,.post li+li{margin-top:.25rem}.page>header,.post>header{margin-bottom:2rem}.page-title,.post-title{margin-top:0}.post-date{display:block;margin-top:-0.5rem;margin-bottom:1rem;color:#9a9a9a}.related-posts{padding-left:0;list-style:none}.related-posts>li,.related-posts>li+li{margin-top:1rem}.related-posts>li>small,.related-posts>li+li>small{font-size:75%;color:#9a9a9a}.message{margin-bottom:1rem;padding:1rem;color:#787878;background-color:#f9f9f9;margin-left:-1rem;margin-right:-1rem}body,main{position:relative;overflow-x:hidden}@media screen{body::before{content:'';background:#e5e5e5;position:absolute;left:0;top:0;bottom:0}}@media screen and (min-width: 40em){html{font-size:17px}}@media screen and (min-width: 54em){html{font-size:16px}}@media screen and (min-width: 88em){html{font-size:15px}}@media screen and (min-width: 125em){html{font-size:18px}}.sr-only{display:none}.clearfix,.sidebar-social::after,.clearafter::after{content:"";display:table;clear:both}a,.a{position:relative;padding-bottom:.15rem;border-style:hidden}.img{overflow:hidden;background-color:#f9f9f9}.img>img{margin:0;width:100%;height:100%}.sixteen-nine{position:relative}.sixteen-nine::before{display:block;content:"";width:100%;padding-top:56.25%}.sixteen-nine>*{position:absolute;top:0;left:0;right:0;bottom:0}h1+hr,h2+hr,h3+hr,h4+hr,h5+hr,h6+hr{margin-top:0}.fade-in{animation-duration:500ms;animation-name:fade-in;animation-fill-mode:forwards}@keyframes fade-in{from{transform:translateY(-2rem);opacity:0}50%{transform:translateY(-2rem);opacity:0}to{transform:translateY(0);opacity:1}}.mb6{margin-bottom:10rem}.sidebar{color:rgba(255,255,255,0.75);text-align:left}.sidebar::before{content:"";position:absolute;z-index:2;top:0;left:0;bottom:0;right:0;background:linear-gradient(to bottom, rgba(32,32,32,0) 0%, rgba(32,32,32,0.5) 100%)}.sidebar a{color:#fff;border-bottom-color:rgba(255,255,255,0.2);text-shadow:2px 2px 4px rgba(0,0,0,0.5)}.right-side{width:100%;margin-left:auto;margin-right:auto}.right-side .ad-first{text-align:center}@media screen{.right-side{max-width:38rem;min-height:100vh}.right-side .ad-second{display:none}}@media screen and (min-width: 54em){.right-side{margin-left:20rem;margin-right:1rem;padding:4rem 1rem 12rem}.right-side .ad-second{text-align:center;display:block}}@media screen and (min-width: 72em){.right-side{margin-left:22rem;max-width:42rem}}@media screen and (min-width: 88em){.right-side{width:162px;margin-left:0rem;margin-right:0rem;padding:0rem;margin-top:10rem;display:block;float:left}}@media screen and (min-width: 96em){.right-side{width:300px;margin-right:0rem}}#_yDrawer{position:relative}@media screen{#_yDrawer{min-height:640px;min-height:100vh}}@media screen and (min-width: 54em){#_yDrawer{width:18rem;margin-left:0}}.sidebar-bg{position:absolute;height:100%;overflow:hidden;top:0;right:0;bottom:0;left:0;background:#202020 center / cover}.sidebar-box{display:flex;justify-content:center}.sidebar-sticky{position:relative;z-index:3}@media screen{.sidebar-sticky{-ms-overflow-style:none;overflow:-moz-scrollbars-none;height:100%;overflow:auto;position:absolute;padding:3rem 0rem;right:2.5rem;left:2.5rem}}.sidebar-sticky::-webkit-scrollbar{display:none}.sidebar-about>h1{color:#fff;font-size:2rem}.sidebar-nav>ul{list-style:none;padding-left:0;margin-bottom:0.5rem}a.sidebar-nav-item{width:100%;font-weight:normal;display:block;line-height:1.75;padding:0.25rem 0;border-bottom:1px solid rgba(255,255,255,0.2)}a.sidebar-nav-subitem{font-weight:normal;display:block;line-height:1.75;padding:0.25rem 0;border-bottom:1px solid rgba(255,255,255,0.2)}@media screen{.y-drawer-scrim{z-index:2}.y-drawer-content{width:18rem;left:-18rem;z-index:3}}.sidebar-social{margin-bottom:.5rem}.sidebar-social>ul{list-style:none;padding-left:0;margin:0 -.25rem}.sidebar-social>ul>li{float:left}.sidebar-social>ul>li>a{display:inline-block;text-align:center;font-size:1.6rem;line-height:3rem;width:3.1249rem;height:4rem;padding:.5rem 0}.sidebar-social>ul li+li{margin-top:0}.fixed-top{position:fixed;top:0;left:0;width:100%;z-index:1}.navbar>.content{padding-top:0;padding-bottom:0;min-height:0;height:0}.menu{display:inline-block;padding:1.75rem 1.5rem;border-bottom:none;margin-left:-1.5rem;color:#9a9a9a !important}.menu::after{content:"\2630"}@media screen and (min-width: 54em){.menu{padding:1.25rem 1.5rem;position:absolute;left:-9999px}.menu:focus{position:static}}.animation-main{pointer-events:none}.loading{display:none}@media print{.menu{display:none}}.animation-main{opacity:0;will-change:opacity}.loading{position:absolute;top:0;right:0;padding:5.25rem 4.5rem;transform-origin:top right;transform:scale(0.33)}.content{position:relative;margin-left:auto;margin-right:auto;padding:5rem 1rem 12rem}@media screen{.content{min-height:100vh}}@media screen and (min-width: 54em){.content{padding:4rem 1rem 12rem;margin-left:19rem;margin-right:3rem}}@media screen and (min-width: 72em){.content{max-width:42rem;margin-left:21rem}}@media screen and (min-width: 88em){.content{float:left;width:100%;margin-left:22rem;margin-right:5rem}}@media screen and (min-width: 96em){.content{max-width:60rem}}@media screen and (min-width: 102em){.content{margin-left:25rem;margin-right:8rem}}.me{width:6.5rem;height:6.5rem;align-self:center;margin-right:20px;border-radius:100%;position:relative}@media screen and (min-width: 40em){.me{width:7rem;height:7rem}}@media screen and (min-width: 54em){.me{width:6.5rem;height:6.5rem}}@media screen and (min-width: 72em){.me{width:7rem;height:7rem}}main>footer{width:100%;position:absolute;bottom:0;left:0;right:0;padding:0 1rem;color:#9a9a9a;font-size:smaller;text-align:center}main>footer>p{margin-bottom:0}html{font-family:'Nanum Gothic', 'sans-serif'}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6,.heading{font-family:'Nanum Gothic', 'sans-serif'}

</style>


<link rel="preload" href="http://localhost:4000/assets/css/hydejack.css?v=6.4.0" as="style" onload="this.rel='stylesheet'">

<style id="_pageStyle">

.content a{color:#4f86aa;border-color:rgba(79,134,170,0.2)}.content a:hover{border-color:#4f86aa}:focus{outline-color:#4f86aa}::selection{color:#fff;background:#4f86aa}::-moz-selection{color:#fff;background:#4f86aa}

</style>


<noscript>
  <link rel="stylesheet" href="http://localhost:4000/assets/css/hydejack.css?v=6.4.0">
  
  
  

  
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
    <style>
      html { font-family: 'Noto Sans KR', 'sans-serif' }
      h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6, .heading { font-family: 'Noto Sans KR', 'sans-serif' }
    </style>
  

  
  <link rel="stylesheet" href="http://localhost:4000/assets/icomoon/style.css">
</noscript>
<!--<![endif]-->

</head>

<body>
  <!-- =============== -->
<!-- MENU            -->
<!-- =============== -->
<div class="navbar fixed-top">
  <div class="content">
    <span class="sr-only">Jump to:</span>
    <a id="_menu" class="menu no-hover" href="#_title">
      <span class="sr-only">Menu</span>
    </a>
  </div>
</div>

<!-- =============== -->
<!-- CONTENT         -->
<!-- =============== -->
<div id="_yPushState">
  <div class="fade-in">
    <main id="_main" class="content" role="main" data-color="#4f86aa" data-image="/assets/img/main-left.jpeg">
      <!--<div style="text-align: center;">&lt;!&ndash; 조회수 노출 HITS &ndash;&gt;
        <a href="http://hits.dwyl.com/localhost:4000/dev/2024/03/04/18-nest-clean-architecture/"
           target="_blank">
          <img src="http://hits.dwyl.com/localhost:4000/dev/2024/03/04/18-nest-clean-architecture/.svg" /></a>
      </div>-->
      

<article id="post-dev/2024/03/04/18-nest-clean-architecture" class="post" role="article">
  <header>
    <h1 class="post-title">
      
        [NestJs] 클린 아키텍처
      
    </h1>

    <p class="post-date heading">
      <time datetime="2024-03-04T00:00:00+09:00">2024-03-04</time>
      









in <a href="/category/dev/" data-flip="title">DEV</a>

      









on <a href="/tag/dev-nestjs/" data-flip="title">NestJs</a>

    </p>

    
  <div class="hr" style="padding-bottom:0"></div>


  </header>
  

  
    <div class="markdown-body">


<br/>
      <ul>
  <li><a href="#1-클린-아키텍처">1. 클린 아키텍처</a></li>
  <li><a href="#2-solid-객체-지향-설계-원칙">2. SOLID 객체 지향 설계 원칙</a></li>
  <li><a href="#3-유저-서비스에-클린-아키텍처-적용하기">3. 유저 서비스에 클린 아키텍처 적용하기</a>
    <ul>
      <li><a href="#31-도메인-레이어">3.1 도메인 레이어</a></li>
      <li><a href="#32-어플리케이션-레이어">3.2 어플리케이션 레이어</a></li>
      <li><a href="#33-인터페이스-레이어">3.3 인터페이스 레이어</a></li>
      <li><a href="#34-인프라-레이어">3.4 인프라 레이어</a></li>
      <li><a href="#35-이메일-모듈">3.5 이메일 모듈</a></li>
    </ul>
  </li>
</ul>

<hr />

<h1 id="1-클린-아키텍처">1. 클린 아키텍처</h1>

<p>클린 아키텍처는 소프트웨어를 여러 동심원 레이어로 나누고 각 레이어에 있는 컴포넌트는 안쪽 원에 있는 컴포넌트에만 의존성을 가지게 한다. 따라서 안쪽 컴포넌트는 바깥 원에 독립적이다.
이 책에서는 클린 아키텍처를 4개의 레이어로 분류했다.</p>

<ul>
  <li>Infrastructure : 외부에서 가져다 쓰는 컴포넌트를 배치한다. 예를 들어 데이터베이스, 이메일 전송, 다른 서비스와의 통신 프로토콜 구현체 등 외부에서 제공하는 인터페이스나 라이브러리를 이용하여 우리 서비스에 맞게 구현한 구현체가 포함된다.</li>
  <li>Interface : 서비스가 제공하는 인터페이스가 구현되는 레이어. 컨트롤러의 외부 요청 형식, 나가는 데이터의 형식 등을 정의한다. 마찬가지로 게이트웨이나 프레젠터 같은 컴포넌트도 외부와의 인터페이스를 담당한다.</li>
  <li>Application : 비즈니스 로직이 구현되는 레이어이다. 서비스 로직들이 여기 존재한다.</li>
  <li>Domain : 애플리케이션의 핵심 도메인을 구현하는 레이어이다. 도메인 레이어는 다른 레이어에 의존하지 않는다. 따라서 애플리케이션이 가져야 하는 핵심 요소만 가진다.</li>
</ul>

<p>클린 아키텍처 작성시 의존성 역전 원칙을 이해해야 한다. 각 레이어는 의존성이 안쪽 원으로 향하는데 구현할때 안쪽 원에서 바깥쪽 원의 구현체가 필요한 경우가 많다. 그때 안쪽 레이어에서는 인터페이스를 정의하고 인터페이스를 구현한 구현체는 바깥 레이어에 둠으로써 해결할 수 있다.</p>

<h1 id="2-solid-객체-지향-설계-원칙">2. SOLID 객체 지향 설계 원칙</h1>

<p>SOLID는 로버트 C. 마틴이 객체 지향 언어로 소프트웨어를 설계할 때의 방법론을 정리한 것이다. SOLID를 적용하면 유지 보수와 확장이 쉬운 시스템을 만들 수 있다.</p>

<ul>
  <li>SRP: 단일 책임 원칙
    <ul>
      <li>이 원칙의 더 정확한 정의는 클래스를 변경하는 이유는 오직 한 가지뿐이어야 한다는 것이다. 클래스를 비대하게 설계하지 말고 크기가 작고 적은 책임을 가지도록 작성해서 변경에 유연하게 대처할 수 있도록 한다.</li>
    </ul>
  </li>
  <li>OCP : 개방-폐쇄 원칙
    <ul>
      <li>확장에는 열려있고 변경에는 닫혀 있어야 한다. 소프트웨어의 요구 사항이 추가되었다고 해서 기존의 소스 코드를 고쳐야 하면 안된다. 즉, 기능의 추가가 기존 코드에는 영향을 끼치지 않도록 하는 구조가 필요하다. 이는 인터페이스를 활용하여 달성할 수 있다. 기능이 구현체가 아닌 인터페이스에 의존하도록 한다. 추가 기능은 인터페이스를 추가한다.</li>
    </ul>
  </li>
  <li>LSP : 리스코프 치환 원칙
    <ul>
      <li>프로그램의 객체는 프로그램의 정확성을 깨뜨리지 않으면서 하위 타입의 인스턴스로 변경 가능해야 한다. 상속 관계에서 자식 클래스의 인스턴스는 부모 클래스로 선언된 함수의 인수로 전달할 수 있다. 실제 동작하는 인스턴스는 인터페이스가 제공하는 기능을 구현한 객체이지만 인터페이스를 사용하는 다른 객체에도 전달할 수 있어야 한다. 따라서 실제 구현체인 자식 인스턴스는 언제든지 부모 또는 인터페이스가 제공해야 하는 기능을 제공하는 다른 구현체로 바꿀 수 있다.</li>
    </ul>
  </li>
  <li>ISP : 인터페이스 분리 원칙
    <ul>
      <li>특정 클라이언트를 위한 인터페이스 여러 개가 범용 인터페이스 하나보다 낫다. 하나의 인터페이스에 의존하게 되면 인터페이스에 기능이 추가될 때 인터페이스를 구현하는 모든 클래스를 수정해야 한다. 이보다는 인터페이스를 기능별로 잘게 쪼개어 특정 클라이언트용 인터페이스로 모아 사용하는 것이 변경에 대해 의존성을 낮추고 유연하게 대처할 수 있는 방법이다.</li>
    </ul>
  </li>
  <li>DIP : 의존관계 역전 원칙
    <ul>
      <li>프로그래머는 추상화에 의존해야지 구체화에 의존하면 안된다. 클린 아키텍처를 구현하기 위해서는 의존관계 역전이 발생하기 마련이고 이를 해소하기 위해 DI를 이용해야 한다. 이는 추후에 살펴본다.</li>
    </ul>
  </li>
</ul>

<h1 id="3-유저-서비스에-클린-아키텍처-적용하기">3. 유저 서비스에 클린 아키텍처 적용하기</h1>

<p>지금까지 레이어 없이 기능별 역할에 따라 Module로 분리했다. 이제 우리가 작성하고 있는 유저 서비스에서 유저 모듈로 그 범위를 좁혀 클린 아키텍처를 적용해보자.
먼저 다음과 같이 4개의 레이어와 모든 레이어에서 공통으로 사용하는 컴포넌트를 작성할 common 디렉터리를 만든다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/src/users
├── application
├── common
├── domain
├── infra
├── interface
</code></pre></div></div>

<h2 id="31-도메인-레이어">3.1 도메인 레이어</h2>

<p>가장 안쪽 레이어인 domain 레이어에는 도메인 객체와 그 도메인 객체의 상태 변화에 따라 발생되는 이벤트가 존재한다. UserModule은 User 도메인 객체를 갖는다.</p>

<ul>
  <li>domain/user.ts</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">User</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span>
    <span class="kr">private</span> <span class="nx">id</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span>
    <span class="kr">private</span> <span class="nx">name</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span>
    <span class="kr">private</span> <span class="nx">email</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span>
    <span class="kr">private</span> <span class="nx">password</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span>
    <span class="kr">private</span> <span class="nx">signupVarificationToken</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span>
  <span class="p">)</span> <span class="p">{}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>User 객체를 생성할 대 UserCreatedEvent 를 발송해야 한다. 이 도메인 이벤트를 발송하는 주체는 User의 생성자가 되어야 하는데 User 클래스는 new 키워드로 생성하므로 EventBus를 주입받을 수가 없다. 따라서 User를 생성하는 팩터리 클래스인 UserFactory를 구현해서 이를 프로바이더로 제공한다.</p>

<ul>
  <li>domain/user.factory.ts</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">EventBus</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@nestjs/cqrs</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">UserCreateEvent</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../event/user-create.event</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">User</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./user</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">UserFactory</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="kr">private</span> <span class="nx">eventBus</span><span class="p">:</span> <span class="nx">EventBus</span><span class="p">)</span> <span class="p">{}</span>

  <span class="nx">create</span><span class="p">(</span>
    <span class="nx">id</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span>
    <span class="nx">name</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span>
    <span class="nx">email</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span>
    <span class="nx">signupVarificationToken</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span>
    <span class="nx">password</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">password</span><span class="p">,</span> <span class="nx">signupVarificationToken</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">eventBus</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="k">new</span> <span class="nx">UserCreateEvent</span><span class="p">(</span><span class="nx">email</span><span class="p">,</span> <span class="nx">signupVarificationToken</span><span class="p">));</span>
    <span class="k">return</span> <span class="nx">user</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<ul>
  <li>users.module.ts</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">UserFactory</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./domain/user.factory</span><span class="dl">'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Module</span><span class="p">({</span>
  <span class="p">...</span>
  <span class="na">providers</span><span class="p">:</span> <span class="p">[</span>
	<span class="p">...</span>
    <span class="nx">UserFactory</span><span class="p">,</span>
  <span class="p">],</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">UsersModule</span> <span class="p">{}</span>
</code></pre></div></div>

<p>UserCreatedEvent는 도메인 레이어에 위치시킨다.</p>

<pre><code class="language-javacript">├── domain
│   ├── cqrs-event.ts
│   ├── user-create.event.ts
│   ├── user.factory.ts
│   └── user.ts
</code></pre>

<h2 id="32-어플리케이션-레이어">3.2 어플리케이션 레이어</h2>

<p>비즈니스 로직이 구현되는 application 레이어를 구현한다. UserEventsHandler를 어플리케이션 레이어로 이동하고 TestHandler는 삭제한다.</p>

<ul>
  <li>application/user-event.handler.ts</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">EventsHandler</span><span class="p">,</span> <span class="nx">IEventHandler</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@nestjs/cqrs</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">UserCreateEvent</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../domain/user-create.event</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">EmailService</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">src/email/email.service</span><span class="dl">'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">EventsHandler</span><span class="p">(</span><span class="nx">UserCreateEvent</span><span class="p">)</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">UserEventsHandler</span> <span class="kr">implements</span> <span class="nx">IEventHandler</span><span class="o">&lt;</span><span class="nx">UserCreateEvent</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="kr">private</span> <span class="na">emailService</span><span class="p">:</span> <span class="nx">EmailService</span><span class="p">)</span> <span class="p">{}</span>

  <span class="k">async</span> <span class="nx">handle</span><span class="p">(</span><span class="na">event</span><span class="p">:</span> <span class="nx">UserCreateEvent</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">switch</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">case</span> <span class="nx">UserCreateEvent</span><span class="p">.</span><span class="na">name</span><span class="p">:</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">UserCreatedEvent!</span><span class="dl">'</span><span class="p">);</span>
        <span class="kd">const</span> <span class="p">{</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">signupVerifyToken</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">event</span> <span class="k">as</span> <span class="nx">UserCreateEvent</span><span class="p">;</span>
        <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">emailService</span><span class="p">.</span><span class="nx">sendMemberJoinVerification</span><span class="p">(</span>
          <span class="nx">email</span><span class="p">,</span>
          <span class="nx">signupVerifyToken</span><span class="p">,</span>
        <span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nl">default</span><span class="p">:</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>커맨드 핸들러도 application 레이어로 이동한다. 이때 커맨드와 이벤트 소스들을 따로 관리하고 싶다면 디렉터리를 따로 만드는 것도 좋다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>├── application
│   ├── command
│   │   ├── create-user.command.ts
│   │   ├── create-user.handler.ts
│   │   ├── login.command.ts
│   │   ├── login.handler.ts
│   │   ├── verify-email.command.ts
│   │   └── verify-email.handler.ts
│   ├── event
│   │   └── user-event.handler.ts
│   └── query
│       ├── get-user-info.handler.ts
│       └── get-user-info.query.ts
</code></pre></div></div>

<h2 id="33-인터페이스-레이어">3.3 인터페이스 레이어</h2>

<p>UsersController와 관계된 소스코드와 userInfo, DTO 관련 클래스들을 모두 interface 디렉터리로 이동한다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>├── interface
│   ├── UserInfo.ts
│   ├── dto
│   │   ├── create-user.dto.ts
│   │   ├── user-login.dto.ts
│   │   └── verify-email.dto.ts
│   └── users.controller.ts
</code></pre></div></div>

<h2 id="34-인프라-레이어">3.4 인프라 레이어</h2>

<p>유저 모듈에서 쓰는 외부 컴포넌트가 포함되도록 한다. 데이터베이스와 이메일 관련 로직이 대상이다. 먼저 엔티티 클래스를 infra/db/entity로 이동한다. UserEntity는 application 레이어에 있는 핸들러가 사용하고 있으므로 DIP를 적용해서 의존관계를 역전한다. 먼저 데이터베이스에 유저 정보를 다루는 인터페이스인 IUserRepository를 선언한다. 이는 domain 레이어에 작성한다.</p>

<ul>
  <li>domain/repository/iuser.repository.ts</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">User</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../user</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="kr">interface</span> <span class="nx">IUserRepository</span> <span class="p">{</span>
  <span class="nl">findByEmail</span><span class="p">:</span> <span class="p">(</span><span class="nx">email</span><span class="p">:</span> <span class="nx">string</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">User</span> <span class="o">|</span> <span class="kc">null</span><span class="o">&gt;</span><span class="p">;</span>
  <span class="nl">save</span><span class="p">:</span> <span class="p">(</span>
    <span class="nx">name</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span>
    <span class="nx">email</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span>
    <span class="nx">password</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span>
    <span class="nx">signupVerifyToken</span><span class="p">:</span> <span class="nx">string</span>
  <span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>IUserRepository의 구현체인 UserRepository는 infra 레이어에서 구현한다.</p>

<ul>
  <li>infra/db/repository/user.repository.ts</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Injectable</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@nestjs/common</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">InjectRepository</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@nestjs/typeorm</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">IUserRepository</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">src/users/domain/repository/iuser.repository</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Connection</span><span class="p">,</span> <span class="nx">Repository</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">typeorm</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">UserEntity</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../entity/user.entity</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">UserFactory</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">src/users/domain/user.factory</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">User</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">src/users/domain/user</span><span class="dl">'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Injectable</span><span class="p">()</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">UserRepository</span> <span class="kr">implements</span> <span class="nx">IUserRepository</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span>
    <span class="kr">private</span> <span class="nx">connection</span><span class="p">:</span> <span class="nx">Connection</span><span class="p">,</span>
    <span class="p">@</span><span class="nd">InjectRepository</span><span class="p">(</span><span class="nx">UserEntity</span><span class="p">)</span>
    <span class="kr">private</span> <span class="nx">userRepository</span><span class="p">:</span> <span class="nx">Repository</span><span class="o">&lt;</span><span class="nx">UserEntity</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="kr">private</span> <span class="nx">userFactory</span><span class="p">:</span> <span class="nx">UserFactory</span><span class="p">,</span>
  <span class="p">)</span> <span class="p">{}</span>

  <span class="k">async</span> <span class="nx">findByEmail</span><span class="p">(</span><span class="nx">email</span><span class="p">:</span> <span class="nx">string</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">User</span> <span class="o">|</span> <span class="kc">null</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">userEntity</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">userRepository</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({</span>
      <span class="na">where</span><span class="p">:</span> <span class="p">{</span> <span class="nx">email</span> <span class="p">},</span>
    <span class="p">});</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">userEntity</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">const</span> <span class="p">{</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">signupVerifyToken</span><span class="p">,</span> <span class="nx">password</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">userEntity</span><span class="p">;</span>

    <span class="c1">// create에는 UserCreateEvent 가 발생하기 때문에 이벤트가 제외된 reconstitute 를 생성하여 사용한다.</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">userFactory</span><span class="p">.</span><span class="nx">reconstitute</span><span class="p">(</span>
      <span class="nx">id</span><span class="p">,</span>
      <span class="nx">name</span><span class="p">,</span>
      <span class="nx">email</span><span class="p">,</span>
      <span class="nx">signupVerifyToken</span><span class="p">,</span>
      <span class="nx">password</span><span class="p">,</span>
    <span class="p">);</span>
  <span class="p">}</span>

  <span class="k">async</span> <span class="nx">save</span><span class="p">(</span>
    <span class="nx">id</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span>
    <span class="nx">name</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span>
    <span class="nx">email</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span>
    <span class="nx">password</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span>
    <span class="nx">signupVerifyToken</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span>
  <span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="c1">// CreateUserHandler에 있던 로직을 이관한다.</span>
    <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">connection</span><span class="p">.</span><span class="nx">transaction</span><span class="p">(</span><span class="k">async</span> <span class="p">(</span><span class="nx">manager</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">UserEntity</span><span class="p">();</span>
      <span class="nx">user</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">id</span><span class="p">;</span>
      <span class="nx">user</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
      <span class="nx">user</span><span class="p">.</span><span class="nx">email</span> <span class="o">=</span> <span class="nx">email</span><span class="p">;</span>
      <span class="nx">user</span><span class="p">.</span><span class="nx">password</span> <span class="o">=</span> <span class="nx">password</span><span class="p">;</span>
      <span class="nx">user</span><span class="p">.</span><span class="nx">signupVerifyToken</span> <span class="o">=</span> <span class="nx">signupVerifyToken</span><span class="p">;</span>

      <span class="k">await</span> <span class="nx">manager</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="nx">user</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>이제 다른 레이어에서 IUserRepository를 이용해 데이터를 다룰 수 있다. CreateUserHandler를 수정하자.</p>

<ul>
  <li>application/event/create-user.handler.ts</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span>
  <span class="nx">Inject</span><span class="p">,</span>
  <span class="nx">Injectable</span><span class="p">,</span>
  <span class="nx">UnprocessableEntityException</span><span class="p">,</span>
<span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@nestjs/common</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">CommandHandler</span><span class="p">,</span> <span class="nx">ICommandHandler</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@nestjs/cqrs</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">CreateUserCommand</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../command/create-user.command</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">uuid</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">uuid</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">IUserRepository</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">src/users/domain/repository/iuser.repository</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">UserFactory</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">src/users/domain/user.factory</span><span class="dl">'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Injectable</span><span class="p">()</span>
<span class="p">@</span><span class="nd">CommandHandler</span><span class="p">(</span><span class="nx">CreateUserCommand</span><span class="p">)</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">CreateUserHandler</span> <span class="kr">implements</span> <span class="nx">ICommandHandler</span><span class="o">&lt;</span><span class="nx">CreateUserCommand</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span>
  	<span class="c1">// UserRepository 토큰을 이용하여 구현된 클래스를 주입받는다.</span>
    <span class="p">@</span><span class="nd">Inject</span><span class="p">(</span><span class="dl">'</span><span class="s1">UserRepository</span><span class="dl">'</span><span class="p">)</span> <span class="kr">private</span> <span class="na">userRepository</span><span class="p">:</span> <span class="nx">IUserRepository</span><span class="p">,</span>
    <span class="kr">private</span> <span class="na">userFactory</span><span class="p">:</span> <span class="nx">UserFactory</span><span class="p">,</span>
  <span class="p">)</span> <span class="p">{}</span>

  <span class="k">async</span> <span class="nx">execute</span><span class="p">(</span><span class="na">command</span><span class="p">:</span> <span class="nx">CreateUserCommand</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">password</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">command</span><span class="p">;</span>
    <span class="c1">// userRepository로 user를 찾는다.</span>
    <span class="kd">const</span> <span class="nx">userExist</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">userRepository</span><span class="p">.</span><span class="nx">findByEmail</span><span class="p">(</span><span class="nx">email</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">userExist</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nx">UnprocessableEntityException</span><span class="p">(</span>
        <span class="dl">'</span><span class="s1">해당 이메일로는 가입할 수 없습니다.</span><span class="dl">'</span><span class="p">,</span>
      <span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">const</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">uuid</span><span class="p">.</span><span class="nx">v1</span><span class="p">();</span>
    <span class="kd">const</span> <span class="nx">signupVerifyToken</span> <span class="o">=</span> <span class="nx">uuid</span><span class="p">.</span><span class="nx">v1</span><span class="p">();</span>

    <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">userRepository</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span>
      <span class="nx">id</span><span class="p">,</span>
      <span class="nx">name</span><span class="p">,</span>
      <span class="nx">email</span><span class="p">,</span>
      <span class="nx">password</span><span class="p">,</span>
      <span class="nx">signupVerifyToken</span><span class="p">,</span>
    <span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">userFactory</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">signupVerifyToken</span><span class="p">,</span> <span class="nx">password</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<ul>
  <li>users.module.ts</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">UserRepository</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./infra/db/repository/user.repository</span><span class="dl">'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Module</span><span class="p">({</span>
  <span class="p">...</span>
  <span class="na">providers</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">...</span>
    <span class="c1">// 커스텀 프로바이더로 주입한다.</span>
    <span class="p">{</span> <span class="na">provide</span><span class="p">:</span> <span class="dl">'</span><span class="s1">UserRepository</span><span class="dl">'</span><span class="p">,</span> <span class="na">useClass</span><span class="p">:</span> <span class="nx">UserRepository</span> <span class="p">},</span>
  <span class="p">],</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">UsersModule</span> <span class="p">{}</span>
</code></pre></div></div>

<h2 id="35-이메일-모듈">3.5 이메일 모듈</h2>

<p>이메일 모듈과 유저 모듈의 결합을 인터페이스로 느슨하게 변경한다. 이메일 모듈은 외부 시스템이기 때문에 infra 에 구현체를 위치시킨다. 또 이 구현체를 사용하는 곳은 UserEventsHandler인데 application 레이어에 존재한다. 따라서 application 레이어에 IEmailService를 정의한다.</p>

<ul>
  <li>application/adapter/iemail.service.ts</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kr">interface</span> <span class="nx">IEmailService</span> <span class="p">{</span>
  <span class="nl">sendMemberJoinVerification</span><span class="p">:</span> <span class="p">(</span>
    <span class="nx">email</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span>
    <span class="nx">signupVerifyToken</span><span class="p">:</span> <span class="nx">string</span>
  <span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>infra 레이어에 인터페이스의 구현체를 작성한다.</p>

<ul>
  <li>infra/adapter/email.service.ts</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Injectable</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@nestjs/common</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">IEmailService</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">src/users/application/adapter/iemail.service</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">EmailService</span> <span class="k">as</span> <span class="nx">ExternalEmailService</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">src/email/email.service</span><span class="dl">'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Injectable</span><span class="p">()</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">EmailService</span> <span class="kr">implements</span> <span class="nx">IEmailService</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="kr">private</span> <span class="nx">emailService</span><span class="p">:</span> <span class="nx">ExternalEmailService</span><span class="p">)</span> <span class="p">{}</span>

  <span class="k">async</span> <span class="nx">sendMemberJoinVerification</span><span class="p">(</span>
    <span class="nx">email</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span>
    <span class="nx">signupVerifyToken</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span>
  <span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">emailService</span><span class="p">.</span><span class="nx">sendMemberJoinVerification</span><span class="p">(</span><span class="nx">email</span><span class="p">,</span> <span class="nx">signupVerifyToken</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>이제 UserEventHandler에 IEmailService를 주입받아 사용하도록 변경한다.</p>

<ul>
  <li>application/event/user-event.handler.ts</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">EventsHandler</span><span class="p">,</span> <span class="nx">IEventHandler</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@nestjs/cqrs</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">UserCreateEvent</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../../domain/user-create.event</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Inject</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@nestjs/common</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">IEmailService</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../adapter/iemail.service</span><span class="dl">'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">EventsHandler</span><span class="p">(</span><span class="nx">UserCreateEvent</span><span class="p">)</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">UserEventsHandler</span> <span class="kr">implements</span> <span class="nx">IEventHandler</span><span class="o">&lt;</span><span class="nx">UserCreateEvent</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(@</span><span class="nd">Inject</span><span class="p">(</span><span class="dl">'</span><span class="s1">EmailService</span><span class="dl">'</span><span class="p">)</span> <span class="kr">private</span> <span class="na">emailService</span><span class="p">:</span> <span class="nx">IEmailService</span><span class="p">)</span> <span class="p">{}</span>

  <span class="k">async</span> <span class="nx">handle</span><span class="p">(</span><span class="na">event</span><span class="p">:</span> <span class="nx">UserCreateEvent</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">switch</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">case</span> <span class="nx">UserCreateEvent</span><span class="p">.</span><span class="na">name</span><span class="p">:</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">UserCreatedEvent!</span><span class="dl">'</span><span class="p">);</span>
        <span class="kd">const</span> <span class="p">{</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">signupVerifyToken</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">event</span> <span class="k">as</span> <span class="nx">UserCreateEvent</span><span class="p">;</span>
        <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">emailService</span><span class="p">.</span><span class="nx">sendMemberJoinVerification</span><span class="p">(</span>
          <span class="nx">email</span><span class="p">,</span>
          <span class="nx">signupVerifyToken</span><span class="p">,</span>
        <span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nl">default</span><span class="p">:</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<ul>
  <li>users.module.ts</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">UserRepository</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./infra/db/repository/user.repository</span><span class="dl">'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Module</span><span class="p">({</span>
  <span class="p">...</span>
  <span class="na">providers</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">...</span>
    <span class="c1">// 커스텀 프로바이더로 주입한다.</span>
    <span class="p">{</span> <span class="na">provide</span><span class="p">:</span> <span class="dl">'</span><span class="s1">UserRepository</span><span class="dl">'</span><span class="p">,</span> <span class="na">useClass</span><span class="p">:</span> <span class="nx">UserRepository</span> <span class="p">},</span>
    <span class="p">{</span> <span class="na">provide</span><span class="p">:</span> <span class="dl">'</span><span class="s1">EmailService</span><span class="dl">'</span><span class="p">,</span> <span class="na">useClass</span><span class="p">:</span> <span class="nx">EmailService</span> <span class="p">},</span>
  <span class="p">],</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">UsersModule</span> <span class="p">{}</span>
</code></pre></div></div>

<p>나머지 핸들러도 동일하게 수정한다.</p>

<hr />

<p><em>본 포스트는 한용재 저자의 <strong>NestJS로 배우는 백엔드 프로그래밍</strong>을 기반으로 스터디하며 정리한 내용들입니다.</em></p>

<ul>
  <li><a href="http://www.yes24.com/Product/Goods/115850682">NestJS로 배우는 백엔드 프로그래밍</a></li>
</ul>

      <br/>
      <br/>
    </div>
    <script>

    </script>
  

</article>

  <hr class="dingbat" />

  <div class="share">
      <h2>Share this post</h2>
      <div class="share-body">
        <a href="http://twitter.com/share?text=[NestJs] 클린 아키텍처&amp;url=http://localhost:4000/dev/2024/03/04/18-nest-clean-architecture/"
    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
            <span class="icon-twitter">
            </span>
        </a>
        <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/dev/2024/03/04/18-nest-clean-architecture/"
    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
            <span class="icon-facebook">
            </span>
        </a>
    </div>
  </div>
  <br/>






  <aside class="author" role="complementary">
    <div class="author">
  <h2 class="page-title hr">
    About
  </h2>
<div class="author-body">
  
    
  

  

  <img
    src="/assets/img/me.jpg"
    class="me"
    alt="gmin"
    srcset="/assets/img/me.jpg 1x,/assets/img/me.jpg 2x"
    
  />


  
  <div class="author-body-description">
    <p>기술을 통해 사람을 돕고 세상을 이롭게 하는 삶을 지향합니다.</p>

  </div>
</div>
</div>

  </aside>





<aside class="related" role="complementary">
  <h2 class="hr">Related Posts</h2>

  <ul class="related-posts">
    
      
      
      
        
        
          


<li class="h4">
  <a href="/dev/2024/03/22/20-nest-config-module-async/" data-flip="title">
    <span>[NestJs] ConfigModule 비동기로 사용하기</span>
  </a>
  <small><time datetime="2024-03-22T00:00:00+09:00">
    2024-03-22
  </time></small>
</li>

        
      
        
        
          


<li class="h4">
  <a href="/dev/2024/03/20/19-typescript-item3/" data-flip="title">
    <span>[TypeScript] 코드 생성과 타입이 관계 없음을 이해하기</span>
  </a>
  <small><time datetime="2024-03-20T00:00:00+09:00">
    2024-03-20
  </time></small>
</li>

        
      
        
          
          
        
        
          


<li class="h4">
  <a href="/dev/2024/03/03/17-nest-cqrs/" data-flip="title">
    <span>[NestJs] CQRS</span>
  </a>
  <small><time datetime="2024-03-03T00:00:00+09:00">
    2024-03-03
  </time></small>
</li>

        
      
    
  </ul>
</aside>



      <footer>
  <hr />
   <p>© 2024.02. by Gmin.Y</p>
 
  <p>
    <code>Powered by <a href="https://gminiy.github.io/">gminiy</a></code>
  </p>
</footer>

    </main>
    <div class="right-side">
<br/>
  <div class="ad-second">
  </div>
</div>

  </div>
  <div id="_yDrawer">
  <div id="_sidebar" class="sidebar">
    <div class="sidebar-bg" style="background-color:#4f86aa;background-image:url(/assets/img/main-left.jpeg)"></div>
    <header class="sidebar-sticky" role="banner">
      <br/>
      <div class="sidebar-about">
        <h1><a id="_title" href="/">Gmin.Y Blog</a></h1>
        <p>세상을 이롭게 하는 기술</p>

      </div>

      <br/>
      <br/>
      <nav class="sidebar-nav heading" role="navigation">
        <span class="sr-only">Navigation:</span>
<ul>
  

  

  
  
  
  
  
    <li>
      <input type="checkbox" id="list-item-1"/>
      <div  class="list-wrapper">
      <a class="sidebar-nav-item" href="/category/dev/">DEV</a>
       <label class="folder" for="list-item-1">▾</label>
    </div>
    <div>
     <ul class="list-body">
       
           
             <li>
               <a class="sidebar-nav-subitem" href="/tag/dev-nestjs/">NestJs</a>
             </li>
           
         
           
             <li>
               <a class="sidebar-nav-subitem" href="/tag/dev-typescript/">TypeScript</a>
             </li>
           
         
     </ul>
    </div>
    </li>

  
  
    <li>
      <input type="checkbox" id="list-item-2"/>
      <div  class="list-wrapper">
      <a class="sidebar-nav-item" href="/about/">About</a>
       
    </div>
    <div>
     <ul class="list-body">
       
           
         
           
         
     </ul>
    </div>
    </li>

  
</ul>

      </nav>
    <br/>

    <form action="/search">
      <div class="tipue_search_left">
        <img src="/assets/tipuesearch/search.png" class="tipue_search_icon">
      </div>
      <div class="tipue_search_right">
        <input type="text" name="q" id="tipue_search_input" pattern=".{1,}" title="At least 1 characters" required></div>
      <div style="clear: both;"></div>
    </form>

    <br/>
      <div class="sidebar-box">
        
          
  

  

  <img
    src="/assets/img/me.jpg"
    class="me"
    alt="gmin"
    srcset="/assets/img/me.jpg 1x,/assets/img/me.jpg 2x"
    
  />


        
      </div>
      

      
      
        <div class="sidebar-social">
          <span class="sr-only">Social:</span>
<ul>
  
    









<li>
  <a href="https://instagram.com/gmin_87">
    <span class="icon-instagram" title="Instagram"></span>
    <span class="sr-only">Instagram</span>
  </a>
</li>

  
    









<li>
  <a href="https://github.com/gminiy">
    <span class="icon-github" title="GitHub"></span>
    <span class="sr-only">GitHub</span>
  </a>
</li>

  
    









<li>
  <a href="mailto:gmini.y@gmail.com">
    <span class="icon-mail" title="Email"></span>
    <span class="sr-only">Email</span>
  </a>
</li>

  
</ul>

        </div>
      
    </header>
  </div>
</div>

</div>

<!-- =============== -->
<!-- SCRIPTS         -->
<!-- =============== -->

<script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-176737306-1', 'auto');
  ga('send', 'pageview');
  loadJSDeferred('https://www.google-analytics.com/analytics.js');
</script>





<!--[if gt IE 8]><!---->
<script src="//ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>
<script>
  WebFont.load({
    
    google: {
      families: 'Lato'.split('|')
    },
    

    custom: {
      families: ['icomoon'],
      urls: ['/assets/icomoon/style.css']
    }
  });
</script>
<!--<![endif]-->


  <!--[if gt IE 9]>-->
  <script>loadJSDeferred('');</script>

  
  <!--<![endif]-->



</body>

</html>
